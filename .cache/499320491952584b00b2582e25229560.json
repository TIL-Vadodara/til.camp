{"dependencies":[{"name":"/Volumes/Work/forks/til.camp/package.json","includedInParent":true,"mtime":1526468255000},{"name":"/Volumes/Work/forks/til.camp/.browserslistrc","includedInParent":true,"mtime":1524300285000},{"name":"/Volumes/Work/forks/til.camp/node_modules/@firebase/database/package.json","includedInParent":true,"mtime":1519337717000},{"name":"./view/CacheNode","loc":{"line":18,"column":26}},{"name":"./snap/ChildrenNode","loc":{"line":19,"column":29}},{"name":"@firebase/util","loc":{"line":21,"column":21}},{"name":"./view/ViewCache","loc":{"line":22,"column":26}},{"name":"./view/View","loc":{"line":23,"column":21}}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0});var e,t=require(\"./view/CacheNode\"),r=require(\"./snap/ChildrenNode\"),i=require(\"@firebase/util\"),n=require(\"@firebase/util\"),o=require(\"./view/ViewCache\"),a=require(\"./view/View\"),s=function(){function s(){this.views_={}}return Object.defineProperty(s,\"__referenceConstructor\",{get:function(){return i.assert(e,\"Reference.ts has not been loaded\"),e},set:function(t){i.assert(!e,\"__referenceConstructor has already been defined\"),e=t},enumerable:!0,configurable:!0}),s.prototype.isEmpty=function(){return n.isEmpty(this.views_)},s.prototype.applyOperation=function(e,t,r){var o=e.source.queryId;if(null!==o){var a=n.safeGet(this.views_,o);return i.assert(null!=a,\"SyncTree gave us an op for an invalid query.\"),a.applyOperation(e,t,r)}var s=[];return n.forEach(this.views_,function(i,n){s=s.concat(n.applyOperation(e,t,r))}),s},s.prototype.addEventRegistration=function(e,i,s,u,l){var c=e.queryIdentifier(),p=n.safeGet(this.views_,c);if(!p){var v=s.calcCompleteEventCache(l?u:null),f=!1;v?f=!0:u instanceof r.ChildrenNode?(v=s.calcCompleteEventChildren(u),f=!1):(v=r.ChildrenNode.EMPTY_NODE,f=!1);var h=new o.ViewCache(new t.CacheNode(v,f,!1),new t.CacheNode(u,l,!1));p=new a.View(e,h),this.views_[c]=p}return p.addEventRegistration(i),p.getInitialEvents(i)},s.prototype.removeEventRegistration=function(e,t,r){var i=e.queryIdentifier(),o=[],a=[],u=this.hasCompleteView();if(\"default\"===i){var l=this;n.forEach(this.views_,function(e,i){a=a.concat(i.removeEventRegistration(t,r)),i.isEmpty()&&(delete l.views_[e],i.getQuery().getQueryParams().loadsAllData()||o.push(i.getQuery()))})}else{var c=n.safeGet(this.views_,i);c&&(a=a.concat(c.removeEventRegistration(t,r)),c.isEmpty()&&(delete this.views_[i],c.getQuery().getQueryParams().loadsAllData()||o.push(c.getQuery())))}return u&&!this.hasCompleteView()&&o.push(new s.__referenceConstructor(e.repo,e.path)),{removed:o,events:a}},s.prototype.getQueryViews=function(){var e=this;return Object.keys(this.views_).map(function(t){return e.views_[t]}).filter(function(e){return!e.getQuery().getQueryParams().loadsAllData()})},s.prototype.getCompleteServerCache=function(e){var t=null;return n.forEach(this.views_,function(r,i){t=t||i.getCompleteServerCache(e)}),t},s.prototype.viewForQuery=function(e){if(e.getQueryParams().loadsAllData())return this.getCompleteView();var t=e.queryIdentifier();return n.safeGet(this.views_,t)},s.prototype.viewExistsForQuery=function(e){return null!=this.viewForQuery(e)},s.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},s.prototype.getCompleteView=function(){return n.findValue(this.views_,function(e){return e.getQuery().getQueryParams().loadsAllData()})||null},s}();exports.SyncPoint=s;"},"hash":"e986eec1b4a451881b7d842d73698d96","cacheData":{"env":{}}}
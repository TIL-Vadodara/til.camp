{"dependencies":[{"name":"/Volumes/Work/forks/til.camp/package.json","includedInParent":true,"mtime":1526468255000},{"name":"/Volumes/Work/forks/til.camp/.browserslistrc","includedInParent":true,"mtime":1524300285000},{"name":"/Volumes/Work/forks/til.camp/node_modules/@firebase/database/package.json","includedInParent":true,"mtime":1519337717000},{"name":"tslib","loc":{"line":18,"column":22}},{"name":"@firebase/util","loc":{"line":23,"column":21}},{"name":"./util/util","loc":{"line":20,"column":21}},{"name":"./ServerActions","loc":{"line":24,"column":30}}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0});var e=require(\"tslib\"),t=require(\"@firebase/util\"),r=require(\"./util/util\"),s=require(\"@firebase/util\"),n=require(\"@firebase/util\"),o=require(\"@firebase/util\"),i=require(\"./ServerActions\"),a=function(i){function a(e,t,s){var n=i.call(this)||this;return n.repoInfo_=e,n.onDataUpdate_=t,n.authTokenProvider_=s,n.log_=r.logWrapper(\"p:rest:\"),n.listens_={},n}return e.__extends(a,i),a.prototype.reportStats=function(e){throw new Error(\"Method not implemented.\")},a.getListenId_=function(e,r){return void 0!==r?\"tag$\"+r:(t.assert(e.getQueryParams().isDefault(),\"should have a tag if it's not a default query.\"),e.path.toString())},a.prototype.listen=function(e,t,r,s){var o=this,i=e.path.toString();this.log_(\"Listen called for \"+i+\" \"+e.queryIdentifier());var u=a.getListenId_(e,r),l={};this.listens_[u]=l;var p=e.getQueryParams().toRestQueryStringParameters();this.restRequest_(i+\".json\",p,function(e,t){var a=t;(404===e&&(a=null,e=null),null===e&&o.onDataUpdate_(i,a,!1,r),n.safeGet(o.listens_,u)===l)&&s(e?401==e?\"permission_denied\":\"rest_error:\"+e:\"ok\",null)})},a.prototype.unlisten=function(e,t){var r=a.getListenId_(e,t);delete this.listens_[r]},a.prototype.refreshAuthToken=function(e){},a.prototype.restRequest_=function(e,t,n){var i=this;void 0===t&&(t={}),t.format=\"export\",this.authTokenProvider_.getToken(!1).then(function(a){var u=a&&a.accessToken;u&&(t.auth=u);var l=(i.repoInfo_.secure?\"https://\":\"http://\")+i.repoInfo_.host+e+\"?\"+o.querystring(t);i.log_(\"Sending REST request for \"+l);var p=new XMLHttpRequest;p.onreadystatechange=function(){if(n&&4===p.readyState){i.log_(\"REST Response for \"+l+\" received. status:\",p.status,\"response:\",p.responseText);var e=null;if(p.status>=200&&p.status<300){try{e=s.jsonEval(p.responseText)}catch(e){r.warn(\"Failed to parse JSON response for \"+l+\": \"+p.responseText)}n(null,e)}else 401!==p.status&&404!==p.status&&r.warn(\"Got unsuccessful REST response for \"+l+\" Status: \"+p.status),n(p.status);n=null}},p.open(\"GET\",l,!0),p.send()})},a}(i.ServerActions);exports.ReadonlyRestClient=a;"},"hash":"d7235e91b3866a772acdfde1811c2fbb","cacheData":{"env":{}}}
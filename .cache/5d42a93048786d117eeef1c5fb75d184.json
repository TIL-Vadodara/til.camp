{"dependencies":[{"name":"/Volumes/Work/forks/til.camp/package.json","includedInParent":true,"mtime":1526468255000},{"name":"/Volumes/Work/forks/til.camp/.browserslistrc","includedInParent":true,"mtime":1524300285000},{"name":"/Volumes/Work/forks/til.camp/node_modules/@firebase/messaging/package.json","includedInParent":true,"mtime":1519337717000},{"name":"@firebase/util","loc":{"line":17,"column":29}},{"name":"./errors","loc":{"line":18,"column":19}},{"name":"../helpers/array-buffer-to-base64","loc":{"line":19,"column":32}},{"name":"./fcm-details","loc":{"line":20,"column":23}}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0});var e=require(\"@firebase/util\"),t=require(\"./errors\"),r=c(t),o=require(\"../helpers/array-buffer-to-base64\"),n=c(o),a=require(\"./fcm-details\"),u=c(a);function c(e){return e&&e.__esModule?e:{default:e}}var d=function(){function t(){this.errorFactory_=new e.ErrorFactory(\"messaging\",\"Messaging\",r.default.map)}return t.prototype.getToken=function(e,t,o){var a=this,c=(0,n.default)(t.getKey(\"p256dh\")),d=(0,n.default)(t.getKey(\"auth\")),i=\"authorized_entity=\"+e+\"&endpoint=\"+t.endpoint+\"&encryption_key=\"+c+\"&encryption_auth=\"+d;o!==u.default.DEFAULT_PUBLIC_VAPID_KEY&&(i+=\"&application_pub_key=\"+(0,n.default)(o));var s=new Headers;s.append(\"Content-Type\",\"application/x-www-form-urlencoded\");var f={method:\"POST\",headers:s,body:i};return fetch(u.default.ENDPOINT+\"/fcm/connect/subscribe\",f).then(function(e){return e.json()}).catch(function(){throw a.errorFactory_.create(r.default.codes.TOKEN_SUBSCRIBE_FAILED)}).then(function(e){var t=e;if(t.error){var o=t.error.message;throw a.errorFactory_.create(r.default.codes.TOKEN_SUBSCRIBE_FAILED,{message:o})}if(!t.token)throw a.errorFactory_.create(r.default.codes.TOKEN_SUBSCRIBE_NO_TOKEN);if(!t.pushSet)throw a.errorFactory_.create(r.default.codes.TOKEN_SUBSCRIBE_NO_PUSH_SET);return{token:t.token,pushSet:t.pushSet}})},t.prototype.updateToken=function(e,t,o,a,c){var d=this,i=(0,n.default)(a.getKey(\"p256dh\")),s=(0,n.default)(a.getKey(\"auth\")),f=\"push_set=\"+o+\"&token=\"+t+\"&authorized_entity=\"+e+\"&endpoint=\"+a.endpoint+\"&encryption_key=\"+i+\"&encryption_auth=\"+s;c!==u.default.DEFAULT_PUBLIC_VAPID_KEY&&(f+=\"&application_pub_key=\"+(0,n.default)(c));var _=new Headers;_.append(\"Content-Type\",\"application/x-www-form-urlencoded\");var p,h={method:\"POST\",headers:_,body:f};return fetch(u.default.ENDPOINT+\"/fcm/connect/subscribe\",h).then(function(e){return p=e,e.json()}).catch(function(){throw d.errorFactory_.create(r.default.codes.TOKEN_UPDATE_FAILED)}).then(function(e){if(!p.ok){var t=e.error.message;throw d.errorFactory_.create(r.default.codes.TOKEN_UPDATE_FAILED,{message:t})}if(!e.token)throw d.errorFactory_.create(r.default.codes.TOKEN_UPDATE_NO_TOKEN);return e.token})},t.prototype.deleteToken=function(e,t,o){var n=this,a=\"authorized_entity=\"+e+\"&token=\"+t+\"&pushSet=\"+o,c=new Headers;c.append(\"Content-Type\",\"application/x-www-form-urlencoded\");var d={method:\"POST\",headers:c,body:a};return fetch(u.default.ENDPOINT+\"/fcm/connect/unsubscribe\",d).then(function(e){if(!e.ok)return e.json().then(function(e){if(e.error){var t=e.error.message;throw n.errorFactory_.create(r.default.codes.TOKEN_UNSUBSCRIBE_FAILED,{message:t})}},function(e){throw n.errorFactory_.create(r.default.codes.TOKEN_UNSUBSCRIBE_FAILED)})})},t}();exports.default=d;"},"hash":"387f8a4c50ac7ba8d70f2492fb299c70","cacheData":{"env":{}}}